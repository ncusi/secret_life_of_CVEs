schema: '2.0'
stages:
  retrieve_cve_dates:
    cmd: python3 dependency_search/retrieve_cve_dates.py data/cve_df_filename data/published_cve_df_filename
    deps:
    - path: data/cve_df_filename
      md5: 2edd1805e47670ff381b6e81f5b03463
      size: 60583695
    - path: dependency_search/retrieve_cve_dates.py
      md5: 1334463f333601c8a0b86ec9b69b6bbf
      size: 2064
    outs:
    - path: data/published_cve_df_filename
      md5: cac0d75d900b0904b5f79c7e35a2beb9
      size: 775181
  retrieve_cve_info:
    cmd: python3 cve_information/retrieve_cve_info.py data/published_cve_df_filename
      data/unique_cve_info-cvss_cwe_etc.parquet
    deps:
    - path: cve_information/retrieve_cve_info.py
      md5: 555e621cac7a1b3da6d461848175a5aa
      size: 3407
    - path: data/published_cve_df_filename
      md5: cac0d75d900b0904b5f79c7e35a2beb9
      size: 775181
    outs:
    - path: data/unique_cve_info-cvss_cwe_etc.parquet
      md5: 11d3d0ba71838bf742de7d766c736aa1
      size: 869228
  retrieve_project_info:
    cmd: python3 projects_stats/retrieve_metadata_from_WoC_mongodb.py data/cve_df_filename
      data/unique_project_info.parquet
    deps:
    - path: data/cve_df_filename
      md5: 2edd1805e47670ff381b6e81f5b03463
      size: 60583695
    - path: projects_stats/retrieve_metadata_from_WoC_mongodb.py
      md5: af3fe986de04dc659cfccf408d74ac17
      size: 9578
    outs:
    - path: data/unique_project_info.parquet
      md5: ab9166e42442236878e119a9c8fcfe49
      size: 2664107
  merge_cve_dates:
    cmd: python3 dependency_search/merge_cve_df_with_published_cve_df.py data/cve_df_filename
      data/published_cve_df_filename data/commits_with_published_cve_df
    deps:
    - path: data/cve_df_filename
      md5: 2edd1805e47670ff381b6e81f5b03463
      size: 60583695
    - path: data/published_cve_df_filename
      md5: cac0d75d900b0904b5f79c7e35a2beb9
      size: 775181
    - path: dependency_search/merge_cve_df_with_published_cve_df.py
      md5: 92cde17947d19098c1d1a5a33f0afc56
      size: 1237
    outs:
    - path: data/commits_with_published_cve_df
      md5: 3e8506d1bba834b6edf8a5e7f3528037
      size: 76845293
  add_cvss_rankings:
    cmd: python3 cve_information/add_cvss_ranking.py data/unique_cve_info-cvss_cwe_etc.parquet
      data/unique_cve_info-cvss_cwe_ranking_etc.parquet
    deps:
    - path: cve_information/add_cvss_ranking.py
      md5: 2a6c2aaae82a0f4b77fc14f23fe43b50
      size: 4346
    - path: data/unique_cve_info-cvss_cwe_etc.parquet
      md5: 11d3d0ba71838bf742de7d766c736aa1
      size: 869228
    outs:
    - path: data/unique_cve_info-cvss_cwe_ranking_etc.parquet
      md5: 2fd6b6671e1c0b8c8c93049d58b294d4
      size: 917236
  extension_to_language:
    cmd: python3 dependency_search/prepare_extension_to_language_dict.py data/extension_to_language.json
    deps:
    - path: dependency_search/prepare_extension_to_language_dict.py
      md5: 355116c3fa764839007208e247ba8740
      size: 2032
    - path: https://raw.githubusercontent.com/github/linguist/master/lib/linguist/languages.yml
      checksum: '"63d3d5d3b8efd4fd6b3bbe70490e6a60f3a47a934af098966717a242b04fb81b"'
      size: 136180
    outs:
    - path: data/extension_to_language.json
      md5: 1d02992b8f88b6502b110c192f85aba6
      size: 19299
  languages_for_cve:
    cmd: python3 dependency_search/find_programming_language_for_cve.py data/commits_with_published_cve_df
      data/extension_to_language.json data/combined_df
    deps:
    - path: data/commits_with_published_cve_df
      md5: 3e8506d1bba834b6edf8a5e7f3528037
      size: 76845293
    - path: data/extension_to_language.json
      md5: 1d02992b8f88b6502b110c192f85aba6
      size: 19299
    - path: dependency_search/find_programming_language_for_cve.py
      md5: 260ae5fab08772353acd86546540ac51
      size: 3263
    outs:
    - path: data/combined_df
      md5: ee44b4e1b17386cdf5e43bce507ba2c1
      size: 80110439
  language_to_class:
    cmd: python3 dependency_search/prepare_language_to_class_dict.py data/language_to_class.json
    deps:
    - path: dependency_search/prepare_language_to_class_dict.py
      md5: 6a743e89e8bcec27515faa1bbc7fc0d8
      size: 3711
    outs:
    - path: data/language_to_class.json
      md5: 3de6771a0070cc9551d6b40ad849e2c8
      size: 4163
  clean_combined_df:
    cmd: python3 dependency_search/clean_data_before_cve_lifespan_calculation.py data/combined_df
      data/dep_df data/language_to_class.json data/cleaned_cve_df
    deps:
    - path: data/combined_df
      md5: ee44b4e1b17386cdf5e43bce507ba2c1
      size: 80110439
    - path: data/dep_df
      md5: 462062bf333cd25670e3e65a9abb980f
      size: 30932536
    - path: data/language_to_class.json
      md5: 3de6771a0070cc9551d6b40ad849e2c8
      size: 4163
    - path: dependency_search/clean_data_before_cve_lifespan_calculation.py
      md5: 0dcea10cfb082122517a96c040c03eeb
      size: 4405
    outs:
    - path: data/cleaned_cve_df
      md5: 45061acdfedd3279de1342a230efd7ee
      size: 48006091
  compute_cve_lifespan:
    cmd: python3 dependency_search/calculate_cve_lifespan_per_project.py data/cleaned_cve_df
      data/language_to_class.json data/cve_lifespan_language_df data/cve_lifespan_df
    deps:
    - path: data/cleaned_cve_df
      md5: 45061acdfedd3279de1342a230efd7ee
      size: 48006091
    - path: data/language_to_class.json
      md5: 3de6771a0070cc9551d6b40ad849e2c8
      size: 4163
    - path: dependency_search/calculate_cve_lifespan_per_project.py
      md5: 0cd864e5d46cea9f052aea7fa64db7a6
      size: 16189
    outs:
    - path: data/cve_lifespan_df
      md5: 50c275285bbecec3bcb9f6819802e5ca
      size: 7773982
    - path: data/cve_lifespan_language_df
      md5: 3c37c7cd552951b4f8642e9cdc85d093
      size: 5155773
  merge_cve_info_into_lifespan:
    cmd: python3 dependency_search/merge_cve_info_and_cve_lifespan.py data/unique_cve_info-cvss_cwe_ranking_etc.parquet
      data/cve_lifespan_language_df data/cve_lifespan_df data/cve_lifespan_and_cve_info_df
      data/cve_lifespan_language_and_cve_info_df
    deps:
    - path: data/cve_lifespan_df
      md5: 50c275285bbecec3bcb9f6819802e5ca
      size: 7773982
    - path: data/cve_lifespan_language_df
      md5: 3c37c7cd552951b4f8642e9cdc85d093
      size: 5155773
    - path: data/unique_cve_info-cvss_cwe_ranking_etc.parquet
      md5: 2fd6b6671e1c0b8c8c93049d58b294d4
      size: 917236
    - path: dependency_search/merge_cve_info_and_cve_lifespan.py
      md5: d8fbc2694d8bd46735090bd1080d3b4d
      size: 1609
    outs:
    - path: data/cve_lifespan_and_cve_info_df
      md5: 4fa8302c35e074b57565fedc3facc34f
      size: 5861656
    - path: data/cve_lifespan_language_and_cve_info_df
      md5: a09e8255bb7731d1f7f5505f6d6b65da
      size: 9231203
  evaluate-cve_surv:
    cmd: python3 analysis/cve_surv_analysis.py --eval-path=eval/ --path-prefix=''
      data/cve_survival_input_df
    deps:
    - path: analysis/cve_surv_analysis.py
      md5: 63dd2aba7d6164c0d01605871a371063
      size: 32766
    - path: data/cve_survival_input_df
      md5: 280c9e8744499ce7e4e07e33214ba74f
      size: 9077406
    params:
      params.yaml:
        eval.bootstrap_samples: 50
        eval.confidence: 0.95
        eval.cve_survival_analysis:
          risk_column_name: embargo_max
        eval.description: no additional filtering
    outs:
    - path: eval/cve_surv_group_metrics.csv
      md5: b11dc5b88e73cc687eccad9a397bde47
      size: 229
    - path: eval/cve_surv_metrics.json
      md5: 34f5c23f3b9b3d5c050547e86fd8a0a7
      size: 462
    - path: eval/cve_surv_params.yaml
      md5: 7e20cc3db638f4d3c134ad9e414edc81
      size: 311
    - path: eval/cve_surv_statistics.csv
      md5: 1d912b77743a3b60a5fef69b26ebdd94
      size: 234
    - path: eval/cve_survival_function.png
      md5: 3e16827a07bb2985981270248fd48ae4
      size: 35062
  merge_project_info_into_lifespan_language:
    cmd: python3 projects_stats/merge_with_project_metadata.py data/cve_lifespan_language_and_cve_info_df  data/unique_project_info.parquet
      data/cve_survival_input_most_used_language_df
    deps:
    - path: data/cve_lifespan_language_and_cve_info_df
      md5: a09e8255bb7731d1f7f5505f6d6b65da
      size: 9231203
    - path: data/unique_project_info.parquet
      md5: ab9166e42442236878e119a9c8fcfe49
      size: 2664107
    - path: projects_stats/merge_with_project_metadata.py
      md5: b9b55377ae37a1e62e19a0ed49ed208b
      size: 5424
    outs:
    - path: data/cve_survival_input_most_used_language_df
      md5: b9462d97633b80edc4fb0560062d3fd6
      size: 14222324
  merge_project_info_into_lifespan:
    cmd: python3 projects_stats/merge_with_project_metadata.py data/cve_lifespan_and_cve_info_df
      data/unique_project_info.parquet data/cve_survival_input_df
    deps:
    - path: data/cve_lifespan_and_cve_info_df
      md5: 4fa8302c35e074b57565fedc3facc34f
      size: 5861656
    - path: data/unique_project_info.parquet
      md5: ab9166e42442236878e119a9c8fcfe49
      size: 2664107
    - path: projects_stats/merge_with_project_metadata.py
      md5: b9b55377ae37a1e62e19a0ed49ed208b
      size: 5424
    outs:
    - path: data/cve_survival_input_df
      md5: 280c9e8744499ce7e4e07e33214ba74f
      size: 9077406
  dependency_df:
    cmd: python3 dependency_search/prepare_dep_df.py data/cve_df_filename data/dep_df
    deps:
    - path: data/cve_df_filename
      md5: 2edd1805e47670ff381b6e81f5b03463
      size: 60583695
    - path: dependency_search/prepare_dep_df.py
      md5: e2493ae952ee56ccb4b0e2779ae58cf9
      size: 834
    outs:
    - path: data/dep_df
      md5: 462062bf333cd25670e3e65a9abb980f
      size: 30932536
